<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" />
  <title>Equi Scoreboard</title>
  <link rel="stylesheet" href="./styles.css?v=20260205m" />
</head>
<body>
  <div id="bg"></div>
  <button id="openSetup" class="setupToggle" type="button">Setup</button>

  <div class="canvas">
    <div class="topbar">
      <div class="competitionInfo">
        <div class="trapezoid">
          <div class="trapHeader">CURRENT COMPETITION</div>
          <div class="trapContent">
            <span class="classNo" id="classNo">H110</span>
            <span class="className" id="className">AGAINST THE CLOCK</span>
          </div>
        </div>
      </div>
      <div class="timeInfo">
        <div class="trapezoid">
          <div class="timeRow">
            <span class="timeLabel">TIME</span>
            <span class="timeValue" id="clock">11:25</span>
          </div>
          <div class="timeRow">
            <span class="timeLabel">Ca. FINISH</span>
            <span class="timeValue" id="finishTime">12:53</span>
          </div>
        </div>
        <button id="openSetup" class="badge setupToggle" type="button">Setup</button>
      </div>
    </div>

    <div class="main">
      <!-- LIVE layout -->
      <div class="gridLive" id="layoutLive">
        <div class="leftPanel">
          <div class="panel">
            <div class="panelHeader">RANKING</div>
            <div class="rows" id="rowsLive"></div>
          </div>
        </div>

        <div class="rightPanel">
          <div class="box sideBox lastBox">
            <div class="boxHeader"><span>LAST</span><span id="lastRank">Rank 2</span></div>
            <div class="boxBody">
              <div class="bigLine"><img class="flagIcon" id="lastFlag" alt="" /><span id="lastRider">—</span></div>
              <div class="midLine" id="lastHorse">—</div>
              <div class="scoreRow">
                <span><span class="scoreLabel">Pt.</span> <span id="lastScore">0</span></span>
                <span id="lastTime">45.81 sec</span>
              </div>
            </div>
          </div>

          <div class="box sideBox currentBox">
            <div class="boxHeader"><span>CURRENT</span><span id="currentCompetitor">19. Competitor</span></div>
            <div class="boxBody">
              <div class="bigLine"><img class="flagIcon" id="currentFlag" alt="" /><span id="currentRider">—</span></div>
              <div class="midLine" id="currentHorse">—</div>
              <div class="currentMetrics">
                <div class="bigTime liveState" id="currentTime">43.22</div>
                <div class="currentPenalty">
                  <span class="penLabel">Pt.</span>
                  <span class="livePenalty" id="currentScore">0</span>
                </div>
              </div>
            </div>
          </div>

          <div class="box sideBox nextBox">
            <div class="boxHeader"><span>NEXT</span></div>
            <div class="boxBody">
              <div class="bigLine"><img class="flagIcon" id="nextFlag" alt="" /><span id="nextRider">—</span></div>
              <div class="midLine" id="nextHorse">—</div>
            </div>
          </div>
        </div>
      </div>

      <div class="bottomStats" id="bottomStats">
        <div class="stat total">
          <div class="label">TOTAL</div>
          <div class="value" id="statTotal">18/42</div>
        </div>
        <div class="stat">
          <div class="label">ALLOWED</div>
          <div class="value" id="statAllowed">60s</div>
        </div>
        <div class="stat">
          <div class="label">BEST</div>
          <div class="value" id="statBest">45.46</div>
        </div>
      </div>

      <!-- FINAL layout -->
      <div class="gridFinal" id="layoutFinal" style="display:none">
        <div class="panel finalPanel">
          <div class="panelHeader">FINAL RESULTS</div>
          <div class="finalTwoCols">
            <div class="rows" id="rowsFinalLeft"></div>
            <div class="rows" id="rowsFinalRight"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="setup" id="setup">
    <div class="setupCard">
      <h2>Setup</h2>
      <div class="grid">
        <div>
          <label>Competition ID (API mode)</label>
          <input id="competitionId" value="14277"/>
        </div>
        <div>
          <label>Arena</label>
          <div class="arenaRow">
            <select id="arenaSelect">
              <option value="">(carica arene…)</option>
            </select>
            <button id="loadArenasBtn" type="button" class="secondary smallBtn">Carica</button>
          </div>
        </div>
        <div>
          <label>Mode / sorgente dati</label>
          <select id="modeSelect">
            <option value="api" selected>API (live)</option>
            <option value="demo">Demo (offline)</option>
            <option value="sample">Equiresults sample (14277 / 322284)</option>
          </select>
        </div>
        <div>
          <label>Layout</label>
          <select id="layoutSelect">
            <option value="live">Live overlay</option>
            <option value="final">Final results (2 colonne)</option>
          </select>
        </div>
      </div>
      <div class="controls">
        <button id="startBtn">Avvia (auto-refresh)</button>
        <div class="setupStatus" id="setupStatus" aria-live="polite"></div>
      </div>
      <div class="hint">
        Demo offline funziona sempre. Se in API mode il browser blocca per CORS/token, passiamo alla variante con proxy.
      </div>
      <div class="status" id="setupStatus"></div>
    </div>
  </div>

  <script src="./app.js?v=20260205m"></script>
</body>
</html>
